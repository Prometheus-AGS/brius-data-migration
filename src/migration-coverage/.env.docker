# Migration Coverage API - Docker Environment Configuration
# Copy this file to .env before running docker-compose

# =============================================================================
# Application Configuration
# =============================================================================

# Runtime environment
NODE_ENV=production

# Server port
PORT=3000

# API Key (optional - for authentication)
# Generate with: openssl rand -base64 32
API_KEY=your-secure-api-key-here

# CORS Origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8080,https://your-frontend-domain.com

# =============================================================================
# Source Database Configuration (Legacy System)
# =============================================================================

# Source database connection (your existing legacy database)
SOURCE_DB_HOST=your-legacy-db-host.com
SOURCE_DB_PORT=5432
SOURCE_DB_NAME=your_legacy_database
SOURCE_DB_USER=your_legacy_user
SOURCE_DB_PASSWORD=your_legacy_password
SOURCE_DB_SSL=true

# Connection pool settings for source
SOURCE_DB_MAX_CONNECTIONS=10
SOURCE_DB_TIMEOUT=30000
SOURCE_DB_IDLE_TIMEOUT=10000

# =============================================================================
# Target Database Configuration (Modern System)
# =============================================================================

# Target database (will be created by docker-compose)
TARGET_DB_NAME=migration_coverage
TARGET_DB_USER=postgres
TARGET_DB_PASSWORD=secure_postgres_password_here
TARGET_DB_PORT=5432

# Connection pool settings for target
TARGET_DB_MAX_CONNECTIONS=20
TARGET_DB_TIMEOUT=30000
TARGET_DB_IDLE_TIMEOUT=10000

# =============================================================================
# Redis Configuration (Optional - for job queuing and caching)
# =============================================================================

REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=optional_redis_password

# =============================================================================
# Nginx Configuration (Production only)
# =============================================================================

NGINX_PORT=80
NGINX_SSL_PORT=443

# =============================================================================
# Monitoring and Logging
# =============================================================================

# Log level (error, warn, info, debug)
LOG_LEVEL=info

# Enable request logging
ENABLE_REQUEST_LOGGING=true

# Metrics collection
ENABLE_METRICS=true
METRICS_PORT=9090

# =============================================================================
# Security Configuration
# =============================================================================

# Rate limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Request size limits
MAX_REQUEST_SIZE=10mb

# Enable/disable features
ENABLE_DEVELOPMENT_ENDPOINTS=false
ENABLE_SWAGGER_UI=false

# =============================================================================
# Performance Tuning
# =============================================================================

# Database connection settings
DB_ACQUIRE_TIMEOUT_MS=60000
DB_CREATE_TIMEOUT_MS=30000
DB_DESTROY_TIMEOUT_MS=5000
DB_REAP_INTERVAL_MS=1000

# Memory settings (for Node.js)
NODE_OPTIONS=--max-old-space-size=2048

# =============================================================================
# Backup and Recovery
# =============================================================================

# Backup configuration (if using backup services)
BACKUP_ENABLED=false
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30

# =============================================================================
# Development Overrides (ignored in production)
# =============================================================================

# Development database (override target for local dev)
DEV_TARGET_DB_HOST=localhost
DEV_TARGET_DB_PORT=5433
DEV_TARGET_DB_NAME=migration_coverage_dev

# Development features
DEV_ENABLE_MOCK_DATA=false
DEV_ENABLE_DEBUG_ENDPOINTS=true

# =============================================================================
# Docker Compose Configuration
# =============================================================================

# Container naming
COMPOSE_PROJECT_NAME=migration-coverage

# Volume settings
DB_DATA_PATH=./data/postgres
REDIS_DATA_PATH=./data/redis
LOGS_PATH=./logs
REPORTS_PATH=./reports

# Resource limits
API_MEMORY_LIMIT=1g
DB_MEMORY_LIMIT=2g
REDIS_MEMORY_LIMIT=256m